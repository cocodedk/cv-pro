<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ personal_info.name or "CV" }}</title>
  <style>
    :root {
      --text: var(--ink, #111);
      --muted: var(--muted, #555);
      --accent: var(--accent, #0f766e);
      --bg-section: #f9fafb;
    }
    {% if theme_css %}{{ theme_css }}{% endif %}
    body {
      font-family: system-ui, -apple-system, sans-serif;
      color: var(--text);
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0;
    }
    header {
      background: linear-gradient(135deg, var(--accent) 0%, #1e40af 100%);
      color: white;
      padding: 64px 24px;
      text-align: center;
    }
    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 32px;
      max-width: 1000px;
      margin: 0 auto;
    }
    .header-text {
      flex: 1;
    }
    .header-photo {
      flex-shrink: 0;
    }
    .cv-photo-circle {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid rgba(255,255,255,0.8);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    h1 {
      font-size: 48px;
      margin: 0 0 8px;
    }
    .cv-title {
      font-size: 24px;
      margin: 0 0 16px;
      opacity: 0.9;
    }
    .cv-contact {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 16px;
      font-size: 14px;
    }
    .cv-contact a {
      color: white;
      text-decoration: none;
    }
    main {
      padding: 48px 24px;
    }
    section {
      margin-bottom: 64px;
    }
    section h2 {
      font-size: 32px;
      margin: 0 0 32px;
      color: var(--text);
      border-bottom: 3px solid var(--accent);
      padding-bottom: 12px;
    }
    .case-study {
      background: var(--bg-section);
      padding: 32px;
      margin-bottom: 32px;
      border-radius: 8px;
      border-left: 4px solid var(--accent);
    }
    .case-study-header {
      margin-bottom: 16px;
    }
    .case-study-title {
      font-size: 24px;
      font-weight: bold;
      margin: 0 0 8px;
    }
    .case-study-meta {
      color: var(--muted);
      font-size: 14px;
    }
    .case-study-content {
      font-size: 16px;
      line-height: 1.8;
    }
    .case-study-content ul {
      margin: 16px 0;
      padding-left: 24px;
    }
    .experience-item {
      margin-bottom: 32px;
      padding: 24px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .exp-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 8px;
    }
    .exp-title {
      font-size: 20px;
      font-weight: bold;
    }
    .exp-company {
      color: var(--accent);
      font-weight: 600;
    }
    .exp-meta {
      color: var(--muted);
      font-size: 14px;
      margin: 4px 0;
    }
    .exp-description {
      margin-top: 12px;
      font-size: 16px;
    }
    .project-item {
      margin-top: 16px;
      padding: 16px;
      background: white;
      border-radius: 4px;
    }
    .project-name {
      font-weight: bold;
      font-size: 18px;
    }
    .project-url {
      color: var(--accent);
      text-decoration: none;
    }
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 24px;
      }
      .cv-photo-circle {
        width: 100px;
        height: 100px;
      }
    }
    @media print {
      header {
        background: var(--accent);
      }
      .case-study, .experience-item {
        box-shadow: none;
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <div class="header-text">
          {% if personal_info.name %}<h1 data-scramble="1">{{ personal_info.name }}</h1>{% endif %}
          {% if personal_info.title %}<p class="cv-title" data-scramble="1">{{ personal_info.title }}</p>{% endif %}
          <div class="cv-contact">
            {% if personal_info.email %}<span><a data-scramble="1" data-scramble-href="1" href="mailto:{{ personal_info.email }}">{{ personal_info.email }}</a></span>{% endif %}
            {% if personal_info.phone %}<span data-scramble="1">{{ personal_info.phone }}</span>{% endif %}
            {% if personal_info.website %}<span><a href="{{ personal_info.website }}">{{ personal_info.website }}</a></span>{% endif %}
            {% if personal_info.linkedin %}<span><a href="{{ personal_info.linkedin }}">LinkedIn</a></span>{% endif %}
            {% if personal_info.github %}<span><a href="{{ personal_info.github }}">GitHub</a></span>{% endif %}
          </div>
        </div>
        {% if personal_info.photo %}
        <div class="header-photo">
          <img class="cv-photo-circle" src="{{ personal_info.photo }}" alt="Photo"/>
        </div>
        {% endif %}
      </div>
    </header>
    <main>
      {% include "components/summary.html" %}
      {% if experience %}
      <section>
        <h2>Experience & Projects</h2>
        {% for exp in experience %}
          <div class="case-study">
            <div class="case-study-header">
              <h3 class="case-study-title">{{ exp.title }} at {{ exp.company }}</h3>
              <div class="case-study-meta">
                {% if exp.location %}{{ exp.location }}{% endif %}
                {% if exp.location and exp.start_date %} · {% endif %}
                {% if exp.start_date %}{{ exp.start_date }}{% endif %}
                {% if exp.start_date and exp.end_date %} – {% endif %}
                {% if exp.end_date %}{{ exp.end_date }}{% endif %}
              </div>
            </div>
            {% if exp.description %}
            <div class="case-study-content">
              {% if exp.description_format == 'list' and exp.description_lines %}
                <ul>
                {% for line in exp.description_lines %}
                  <li>{{ line }}</li>
                {% endfor %}
                </ul>
              {% elif exp.description_format == 'paragraphs' and exp.description_paragraphs %}
                {% for para in exp.description_paragraphs %}
                  <p>{{ para }}</p>
                {% endfor %}
              {% elif exp.description_text %}
                <div>{{ exp.description_text | safe }}</div>
              {% endif %}
            </div>
            {% endif %}
            {% if exp.projects %}
            <div class="exp-projects">
              {% for project in exp.projects %}
                <div class="project-item">
                  <div class="project-header">
                    <span class="project-name">{{ project.name }}</span>
                    {% if project.url %}<a href="{{ project.url }}" class="project-url">{{ project.url }}</a>{% endif %}
                  </div>
                  {% if project.description %}<div class="project-description">{{ project.description | safe }}</div>{% endif %}
                  {% if project.technologies %}<div class="project-tech">{{ project.technologies | join(', ') }}</div>{% endif %}
                  {% if project.highlights %}
                    <ul class="project-highlights">
                    {% for highlight in project.highlights %}
                      <li>{{ highlight }}</li>
                    {% endfor %}
                    </ul>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
            {% endif %}
          </div>
        {% endfor %}
      </section>
      {% endif %}
      {% if education %}
      <section>
        <h2>Education</h2>
        {% for edu in education %}
          {% include "components/education_item.html" %}
        {% endfor %}
      </section>
      {% endif %}
      {% if skills_by_category %}
      <section>
        <h2>Skills</h2>
        {% include "components/skills_list.html" %}
      </section>
      {% endif %}
    </main>
  </div>
</body>
</html>
